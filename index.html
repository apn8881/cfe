<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ã‡πâ‡∏≥ (‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        /* CSS styles remain the same as previous version */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #f9f9f9;
        }
        .section-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            border-bottom: 1px solid #ddd;
            padding-bottom: 8px;
        }
        .btn {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
            margin: 5px;
        }
        .btn:hover {
            background-color: #2980b9;
        }
        .btn-success {
            background-color: #27ae60;
        }
        .btn-success:hover {
            background-color: #219955;
        }
        .btn-danger {
            background-color: #e74c3c;
        }
        .btn-danger:hover {
            background-color: #c0392b;
        }
        .btn-warning {
            background-color: #f39c12;
        }
        .btn-warning:hover {
            background-color: #e67e22;
        }
        .btn-secondary {
            background-color: #95a5a6;
        }
        .btn-secondary:hover {
            background-color: #7f8c8d;
        }
        .btn:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        .file-input {
            margin-bottom: 15px;
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            background-color: #e8f4fc;
        }
        .result h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        .hidden {
            display: none;
        }
        .instructions {
            background-color: #e8f5e9;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .instructions ol {
            margin-top: 0;
            padding-left: 20px;
        }
        .instructions li {
            margin-bottom: 8px;
        }
        .button-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        .warning {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .info-box {
            background-color: #e8f4fc;
            border: 1px solid #b3e0ff;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .stat-box {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .stat-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #2c3e50;
        }
        .success-message {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .error-message {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .limit-info {
            background-color: #e7f3ff;
            border: 1px solid #b3d9ff;
            color: #004085;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            text-align: center;
        }
        .online-info {
            background-color: #e8f6f3;
            border: 1px solid #a3e4d7;
            color: #0d5c4a;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            text-align: center;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 500px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .progress-bar {
            width: 100%;
            height: 20px;
            background-color: #f0f0f0;
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
        }
        .progress {
            height: 100%;
            background-color: #3498db;
            width: 0%;
            transition: width 0.3s;
        }
        .progress-text {
            margin-top: 10px;
            font-size: 14px;
            color: #666;
        }
        .password-modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        .password-modal-content {
            background-color: white;
            margin: 20% auto;
            padding: 30px;
            border-radius: 10px;
            width: 80%;
            max-width: 400px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        .password-input {
            width: 100%;
            padding: 10px;
            margin: 15px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            box-sizing: border-box;
        }
        .password-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
        }
        .file-info {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        .performance-info {
            background-color: #e8f6f3;
            border: 1px solid #a3e4d7;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        .download-info {
            background-color: #e8f5e9;
            border: 1px solid #c8e6c9;
            border-radius: 5px;
            padding: 10px;
            margin: 10px 0;
            font-size: 0.9em;
        }
        .online-status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .online-active {
            background-color: #d4edda;
            color: #155724;
        }
        .online-inactive {
            background-color: #f8d7da;
            color: #721c24;
        }
        .github-features {
            background-color: #f6f8fa;
            border: 1px solid #d0d7de;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .feature-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .feature-item {
            background: white;
            padding: 10px;
            border-radius: 5px;
            border-left: 4px solid #238636;
        }
        .admin-section {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .fix-section {
            background-color: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .manual-setup {
            background-color: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 5px;
            padding: 15px;
            margin: 10px 0;
        }
        .code-block {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 15px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        .config-input {
            width: 100%;
            padding: 8px;
            margin: 5px 0;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        .header-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-buttons">
            <h1>‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏ä‡πá‡∏Ñ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ã‡πâ‡∏≥ (‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub)</h1>
            <button class="btn btn-secondary" id="settingsBtn">‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>
        
        <div class="instructions">
            <h3>‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:</h3>
            <ol>
                <li>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≥</li>
                <li>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡∏∞‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</li>
                <li>‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß</li>
            </ol>
            <div class="online-info">
                <strong>üåê ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub:</strong> 
                <span id="onlineStatus" class="online-status online-active">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span> | 
                <span id="repoInfo">apn8881/datacfe</span>
            </div>
            <div class="github-features">
                <strong>üöÄ GitHub Database Features:</strong>
                <div class="feature-list">
                    <div class="feature-item">‚úÖ Real-time Sync</div>
                    <div class="feature-item">‚úÖ Version Control</div>
                    <div class="feature-item">‚úÖ Backup ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
                    <div class="feature-item">‚úÖ Team Collaboration</div>
                </div>
            </div>
            <div class="performance-info">
                <strong>‚ö° ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏π‡∏á:</strong> ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡πÄ‡∏£‡πá‡∏ß‡∏ñ‡∏∂‡∏á <strong>50,000-100,000 ‡πÄ‡∏ö‡∏≠‡∏£‡πå/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</strong>
            </div>
            <div class="limit-info">
                <strong>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏à‡∏≥‡∏Å‡∏±‡∏î:</strong> ‡πÑ‡∏ü‡∏•‡πå Excel ‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô <strong>300,000 ‡πÄ‡∏ö‡∏≠‡∏£‡πå</strong>
            </div>
        </div>

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤ -->
        <div class="section fix-section">
            <div class="section-title">üîß ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub</div>
            <p><strong>‡∏õ‡∏±‡∏ç‡∏´‡∏≤:</strong> ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô GitHub repository ‡πÑ‡∏î‡πâ</p>
            <div class="button-container">
                <button class="btn btn-success" id="initDatabaseBtn">‡∏•‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà</button>
                <button class="btn btn-warning" id="testConnectionBtn">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub</button>
                <button class="btn" id="viewOnlineBtn">‡∏î‡∏π Repository ‡πÉ‡∏ô GitHub</button>
            </div>
            <div id="fixStatus"></div>
        </div>

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ -->
        <div class="section manual-setup">
            <div class="section-title">üìù ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠ (‡∏ñ‡πâ‡∏≤‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô)</div>
            <p><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1:</strong> ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Repository ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
            <div class="button-container">
                <a href="https://github.com/apn8881/datacfe" target="_blank" class="btn">
                    ‡πÄ‡∏õ‡∏¥‡∏î GitHub Repository
                </a>
            </div>
            
            <p><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2:</strong> ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå data/phones.json ‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠</p>
            <ol>
                <li>‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "Add file" ‚Üí "Create new file"</li>
                <li>‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå: <code>data/phones.json</code></li>
                <li>‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡πÑ‡∏õ‡∏ß‡∏≤‡∏á:</li>
            </ol>
            
            <div class="code-block">
[]
            </div>
            
            <p><strong>‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3:</strong> Commit ‡πÑ‡∏ü‡∏•‡πå</p>
            <ul>
                <li>‡πÉ‡∏™‡πà Commit message: "Initialize phone database"</li>
                <li>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "Commit directly to the main branch"</li>
                <li>‡∏Ñ‡∏•‡∏¥‡∏Å "Commit new file"</li>
            </ul>
            
            <div class="button-container">
                <button class="btn btn-success" id="checkManualSetupBtn">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
            </div>
        </div>

        <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Admin -->
        <div class="section admin-section">
            <div class="section-title">‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
            <div class="button-container">
                <button class="btn btn-warning" id="saveToOnlineBtn">‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub</button>
                <button class="btn btn-danger" id="clearDbBtn">‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                <button class="btn btn-warning" id="loadFromOnlineBtn">‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub</button>
            </div>
            <div id="configStatus"></div>
        </div>

        <div class="section">
            <div class="section-title">1. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel</div>
            <div class="file-input">
                <input type="file" id="fileInput" accept=".xlsx, .xls">
            </div>
            <div id="fileInfo" class="file-info hidden">
                <strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå:</strong>
                <div id="fileDetails"></div>
            </div>
            <div class="button-container">
                <button class="btn" id="uploadBtn">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</button>
            </div>
            <div id="uploadStatus"></div>
        </div>

        <div class="section">
            <div class="section-title">2. ‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</div>
            <div class="button-container">
                <button class="btn" id="viewDbBtn">‡∏î‡∏π‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</button>
                <button class="btn" id="exportDbBtn">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
            </div>
            <div id="dbInfo" class="result hidden">
                <h3>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <div id="dbCount"></div>
            </div>
        </div>

        <div class="section">
            <div class="section-title">3. ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
            <div id="result" class="result hidden">
                <h3>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</h3>
                <div id="summary"></div>
                <div id="downloadInfo" class="download-info hidden">
                    <strong>üì• ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î:</strong> 
                    <span id="uniqueCount">0</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                </div>
                <div class="button-container">
                    <button class="btn btn-success" id="downloadBtn">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≥‡∏≠‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Modal -->
    <div id="loadingModal" class="modal">
        <div class="modal-content">
            <div class="loader"></div>
            <h3>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå...</h3>
            <p id="loadingMessage">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà</p>
            <div class="progress-bar">
                <div class="progress" id="progressBar"></div>
            </div>
            <div class="progress-text" id="progressText">0%</div>
            <p id="processingInfo"></p>
            <div id="performanceStats" class="performance-info" style="margin-top: 15px; display: none;"></div>
        </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="password-modal">
        <div class="password-modal-content">
            <h3>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</p>
            <input type="password" id="passwordInput" class="password-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô 23669">
            <div class="password-buttons">
                <button class="btn btn-success" id="confirmPasswordBtn">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button class="btn btn-secondary" id="cancelPasswordBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
            <p id="passwordError" style="color: #e74c3c; margin-top: 10px; display: none;">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>
            <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</p>
            <input type="password" id="settingsPasswordInput" class="password-input" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô 23669">
            <div class="password-buttons">
                <button class="btn btn-success" id="confirmSettingsPasswordBtn">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</button>
                <button class="btn btn-secondary" id="cancelSettingsPasswordBtn">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
            </div>
            <p id="settingsPasswordError" style="color: #e74c3c; margin-top: 10px; display: none;">‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
        </div>
    </div>

    <!-- Settings Content Modal -->
    <div id="settingsContentModal" class="modal">
        <div class="modal-content" style="max-width: 600px; text-align: left;">
            <h3>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>
            
            <div class="section">
                <div class="section-title">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub</div>
                <div>
                    <label><strong>GitHub Username:</strong></label>
                    <input type="text" id="settingsGithubUsername" class="config-input" value="apn8881">
                </div>

                <div>
                    <label><strong>Repository Name:</strong></label>
                    <input type="text" id="settingsRepoName" class="config-input" value="datacfe">
                </div>

                <div>
                    <label><strong>Personal Access Token:</strong></label>
                    <input type="password" id="settingsGithubToken" class="config-input" value="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">
                    <small>‡πÑ‡∏î‡πâ‡∏à‡∏≤‡∏Å GitHub Settings ‚Üí Developer settings</small>
                </div>

                <div>
                    <label><strong>File Path:</strong></label>
                    <input type="text" id="settingsFilePath" class="config-input" value="data/phones.json">
                    <small>‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô repository ‡πÄ‡∏ä‡πà‡∏ô data/phones.json</small>
                </div>

                <div class="button-container">
                    <button class="btn btn-success" id="saveSettingsBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                    <button class="btn btn-warning" id="testSettingsBtn">‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
                </div>
                <div id="settingsStatus"></div>
            </div>

            <div class="section">
                <div class="section-title">‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</div>
                <div>
                    <label><strong>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö:</strong></label>
                    <input type="password" id="settingsAdminPassword" class="config-input" value="23669">
                </div>

                <div>
                    <label><strong>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå:</strong></label>
                    <input type="number" id="settingsMaxPhones" class="config-input" value="300000">
                </div>

                <div class="button-container">
                    <button class="btn btn-success" id="saveSystemSettingsBtn">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</button>
                    <button class="btn btn-secondary" id="resetSettingsBtn">‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                </div>
            </div>

            <div class="button-container" style="margin-top: 20px;">
                <button class="btn btn-secondary" id="closeSettingsBtn">‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
            </div>
        </div>
    </div>

    <script>
        // ‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏•‡∏∞ Configuration
        const DEFAULT_MAX_PHONES_PER_FILE = 300000;
        const ADMIN_PASSWORD = "23669";
        const CHUNK_SIZE = 50000;
        const BATCH_SIZE = 1000;

        // ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö
        let MAX_PHONES_PER_FILE = DEFAULT_MAX_PHONES_PER_FILE;

        // GitHub Configuration
        const GITHUB_CONFIG = {
            username: "apn8881",
            repoName: "datacfe",
            token: "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",
            filePath: "data/phones.json"
        };

        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏î‡πâ‡∏ß‡∏¢ GitHub
        class GitHubPhoneDatabase {
            constructor() {
                this.storageKey = 'phoneDatabase';
                this.configKey = 'onlineConfig';
                this.lastUploadKey = 'lastUploadData';
                this.phoneSet = new Set();
                this.pendingAdds = new Set();
                this.lastUploadUniquePhones = [];
                this.onlineEnabled = true;
                this.isSaving = false;
                
                // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å configuration
                this.githubUsername = GITHUB_CONFIG.username;
                this.repoName = GITHUB_CONFIG.repoName;
                this.githubToken = GITHUB_CONFIG.token;
                this.filePath = GITHUB_CONFIG.filePath;
                
                this.load();
            }

            load() {
                try {
                    // ‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô
                    const saved = localStorage.getItem(this.storageKey);
                    if (saved) {
                        const phoneArray = JSON.parse(saved);
                        this.phoneSet = new Set(phoneArray);
                        console.log('‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', this.phoneSet.size, '‡πÄ‡∏ö‡∏≠‡∏£‡πå');
                    }

                    // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
                    const lastUpload = localStorage.getItem(this.lastUploadKey);
                    if (lastUpload) {
                        this.lastUploadUniquePhones = JSON.parse(lastUpload);
                    }

                    console.log('‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    updateOnlineStatus(true);
                    
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                    this.phoneSet = new Set();
                    this.lastUploadUniquePhones = [];
                }
            }

            // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            updateConfig(newConfig) {
                this.githubUsername = newConfig.username;
                this.repoName = newConfig.repoName;
                this.githubToken = newConfig.token;
                this.filePath = newConfig.filePath;
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡∏°‡πà
                const config = { 
                    githubUsername: newConfig.username,
                    repoName: newConfig.repoName,
                    githubToken: newConfig.token,
                    filePath: newConfig.filePath
                };
                localStorage.setItem(this.configKey, JSON.stringify(config));
                
                console.log('‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                updateOnlineStatus(true);
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á headers ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub API
            getHeaders() {
                return {
                    'Authorization': `token ${this.githubToken}`,
                    'Accept': 'application/vnd.github.v3+json',
                    'Content-Type': 'application/json'
                };
            }

            // ‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub
            async fetchFromOnline() {
                if (!this.onlineEnabled) {
                    throw new Error('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                }

                try {
                    const url = `https://api.github.com/repos/${this.githubUsername}/${this.repoName}/contents/${this.filePath}`;
                    const response = await fetch(url, {
                        headers: this.getHeaders()
                    });
                    
                    if (!response.ok) {
                        if (response.status === 404) {
                            console.log('‡πÑ‡∏ü‡∏•‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏ô GitHub');
                            return [];
                        }
                        const errorData = await response.json();
                        throw new Error(`GitHub API Error: ${errorData.message} (Status: ${response.status})`);
                    }

                    const data = await response.json();
                    
                    if (!data.content || data.content === '') {
                        console.log('‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                        return [];
                    }
                    
                    const content = atob(data.content.replace(/\n/g, ''));
                    
                    if (!content || content.trim() === '') {
                        console.log('‡πÑ‡∏ü‡∏•‡πå‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤');
                        return [];
                    }
                    
                    try {
                        const phones = JSON.parse(content);
                        console.log('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', phones.length, '‡πÄ‡∏ö‡∏≠‡∏£‡πå');
                        return Array.isArray(phones) ? phones : [];
                    } catch (parseError) {
                        console.error('‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö JSON ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á:', parseError);
                        return [];
                    }
                    
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub:', error);
                    throw error;
                }
            }

            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
            async initializeDatabase() {
                try {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô
                    const testResponse = await fetch(
                        `https://api.github.com/repos/${this.githubUsername}/${this.repoName}`,
                        { headers: this.getHeaders() }
                    );
                    
                    if (!testResponse.ok) {
                        const errorData = await testResponse.json();
                        throw new Error(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á repository: ${errorData.message}`);
                    }

                    // ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå
                    const initialData = [];
                    const content = btoa(JSON.stringify(initialData, null, 2));
                    const url = `https://api.github.com/repos/${this.githubUsername}/${this.repoName}/contents/${this.filePath}`;
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    let currentSha = null;
                    try {
                        const currentFileResponse = await fetch(url, {
                            headers: this.getHeaders()
                        });
                        if (currentFileResponse.ok) {
                            const currentFile = await currentFileResponse.json();
                            currentSha = currentFile.sha;
                        }
                    } catch (error) {
                        // ‡πÑ‡∏ü‡∏•‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                    }

                    const response = await fetch(url, {
                        method: 'PUT',
                        headers: this.getHeaders(),
                        body: JSON.stringify({
                            message: `Initialize phone database - ${new Date().toLocaleString()}`,
                            content: content,
                            sha: currentSha
                        })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        let errorMessage = `‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ${errorData.message}`;
                        
                        if (errorData.message.includes('push')) {
                            errorMessage += '\n\n‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô: Token ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô repository ‡∏ô‡∏µ‡πâ';
                        } else if (errorData.message.includes('exist')) {
                            errorMessage += '\n\n‚ÑπÔ∏è ‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏î‡πâ';
                        }
                        
                        throw new Error(errorMessage);
                    }

                    const result = await response.json();
                    console.log('‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', result);
                    return { 
                        success: true,
                        commitUrl: result.commit.html_url
                    };
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                    throw error;
                }
            }

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub
            async syncToOnline(phones) {
                if (!this.onlineEnabled) {
                    throw new Error('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                }

                try {
                    // ‡∏£‡∏±‡∏ö SHA ‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                    let currentSha = null;
                    try {
                        const currentFileResponse = await fetch(
                            `https://api.github.com/repos/${this.githubUsername}/${this.repoName}/contents/${this.filePath}`,
                            { headers: this.getHeaders() }
                        );
                        if (currentFileResponse.ok) {
                            const currentFile = await currentFileResponse.json();
                            currentSha = currentFile.sha;
                        }
                    } catch (error) {
                        // ‡πÑ‡∏ü‡∏•‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ
                    }

                    const content = btoa(JSON.stringify(phones, null, 2));
                    const url = `https://api.github.com/repos/${this.githubUsername}/${this.repoName}/contents/${this.filePath}`;
                    
                    const response = await fetch(url, {
                        method: 'PUT',
                        headers: this.getHeaders(),
                        body: JSON.stringify({
                            message: `Update phone database - ${new Date().toLocaleString()}`,
                            content: content,
                            sha: currentSha
                        })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(`‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡πÑ‡∏î‡πâ: ${errorData.message}`);
                    }

                    const data = await response.json();
                    console.log('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', phones.length, '‡πÄ‡∏ö‡∏≠‡∏£‡πå');
                    return { 
                        success: true, 
                        savedCount: phones.length,
                        commitUrl: data.commit.html_url 
                    };
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub:', error);
                    throw error;
                }
            }

            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
            async loadFromOnline() {
                if (!this.onlineEnabled) {
                    throw new Error('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                }

                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub...');
                
                try {
                    const onlinePhones = await this.fetchFromOnline();
                    
                    let newCount = 0;
                    for (const phone of onlinePhones) {
                        if (!this.phoneSet.has(phone)) {
                            this.phoneSet.add(phone);
                            newCount++;
                        }
                    }

                    await this.save();

                    hideLoading();
                    return {
                        success: true,
                        onlineCount: onlinePhones.length,
                        newCount: newCount,
                        totalCount: this.phoneSet.size
                    };
                } catch (error) {
                    hideLoading();
                    throw error;
                }
            }

            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
            async saveToOnline() {
                if (!this.onlineEnabled) {
                    throw new Error('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                }

                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub...');
                
                try {
                    const allPhones = Array.from(this.phoneSet);
                    const result = await this.syncToOnline(allPhones);
                    
                    hideLoading();
                    return {
                        success: true,
                        savedCount: result.savedCount,
                        commitUrl: result.commitUrl
                    };
                } catch (error) {
                    hideLoading();
                    throw error;
                }
            }

            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
            async testConnection() {
                if (!this.onlineEnabled) {
                    throw new Error('‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡∏ñ‡∏π‡∏Å‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                }

                try {
                    const onlinePhones = await this.fetchFromOnline();
                    return {
                        success: true,
                        count: onlinePhones.length,
                        message: onlinePhones.length === 0 ? 
                            '‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (‡πÑ‡∏ü‡∏•‡πå‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤)' : 
                            `‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏ö ${onlinePhones.length} ‡πÄ‡∏ö‡∏≠‡∏£‡πå`
                    };
                } catch (error) {
                    throw error;
                }
            }

            // ‡∏£‡∏±‡∏ö URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô GitHub
            getOnlineUrl() {
                if (!this.onlineEnabled) {
                    return null;
                }
                return `https://github.com/${this.githubUsername}/${this.repoName}`;
            }

            getFileUrl() {
                if (!this.onlineEnabled) {
                    return null;
                }
                return `https://github.com/${this.githubUsername}/${this.repoName}/blob/main/${this.filePath}`;
            }

            // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏î‡∏¥‡∏°
            saveLastUpload(uniquePhones) {
                this.lastUploadUniquePhones = uniquePhones;
                try {
                    localStorage.setItem(this.lastUploadKey, JSON.stringify(uniquePhones));
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:', error);
                }
            }

            getLastUploadData() {
                return this.lastUploadUniquePhones;
            }

            async save() {
                if (this.isSaving) return;
                
                this.isSaving = true;
                try {
                    const phoneArray = Array.from(this.phoneSet);
                    localStorage.setItem(this.storageKey, JSON.stringify(phoneArray));
                    this.pendingAdds.clear();
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', error);
                    if (error.name === 'QuotaExceededError') {
                        this.clearOldData();
                        await this.save();
                    }
                } finally {
                    this.isSaving = false;
                }
            }

            async saveBatch() {
                return new Promise(resolve => {
                    setTimeout(() => {
                        this.save().then(resolve);
                    }, 100);
                });
            }

            clearOldData() {
                const phoneArray = Array.from(this.phoneSet);
                const halfSize = Math.floor(phoneArray.length / 2);
                this.phoneSet = new Set(phoneArray.slice(-halfSize));
            }

            checkMultiplePhones(phones) {
                const results = [];
                for (const phone of phones) {
                    results.push({
                        phone: phone,
                        isDuplicate: this.phoneSet.has(phone)
                    });
                }
                return results;
            }

            async addMultiplePhones(phoneResults) {
                let newCount = 0;
                const newPhones = [];

                for (const result of phoneResults) {
                    if (!result.isDuplicate) {
                        this.phoneSet.add(result.phone);
                        this.pendingAdds.add(result.phone);
                        newCount++;
                        newPhones.push(result.phone);
                    }
                }

                if (this.pendingAdds.size >= BATCH_SIZE) {
                    await this.saveBatch();
                }

                return { 
                    newCount, 
                    duplicateCount: phoneResults.length - newCount,
                    newPhones 
                };
            }

            async getCount() {
                return this.phoneSet.size;
            }

            async clear() {
                this.phoneSet.clear();
                this.pendingAdds.clear();
                this.lastUploadUniquePhones = [];
                localStorage.removeItem(this.storageKey);
                localStorage.removeItem(this.lastUploadKey);
            }

            async exportToArray() {
                return Array.from(this.phoneSet);
            }

            async flush() {
                if (this.pendingAdds.size > 0) {
                    await this.save();
                }
            }
        }

        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å
        const phoneDB = new GitHubPhoneDatabase();
        let startTime = 0;
        let currentUniquePhones = [];
        let currentPasswordAction = null;

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
        function updateOnlineStatus(isActive) {
            const statusElement = document.getElementById('onlineStatus');
            const repoInfoElement = document.getElementById('repoInfo');
            
            if (isActive) {
                statusElement.textContent = '‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                statusElement.className = 'online-status online-active';
                repoInfoElement.textContent = `${phoneDB.githubUsername}/${phoneDB.repoName}`;
            } else {
                statusElement.textContent = '‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                statusElement.className = 'online-status online-inactive';
            }
        }

        // ‡πÅ‡∏™‡∏î‡∏á loading modal
        function showLoading(message = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà") {
            document.getElementById('loadingMessage').textContent = message;
            document.getElementById('loadingModal').style.display = 'block';
            document.getElementById('performanceStats').style.display = 'none';
        }

        // ‡∏ã‡πà‡∏≠‡∏ô loading modal
        function hideLoading() {
            document.getElementById('loadingModal').style.display = 'none';
            resetProgress();
        }

        // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó progress bar
        function updateProgress(percent, message = "") {
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const processingInfo = document.getElementById('processingInfo');
            
            progressBar.style.width = percent + '%';
            progressText.textContent = percent + '%';
            
            if (message) {
                processingInfo.textContent = message;
            }
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
        function showPerformanceStats(processedCount, elapsedTime) {
            const statsDiv = document.getElementById('performanceStats');
            const phonesPerSecond = Math.round(processedCount / (elapsedTime / 1000));
            
            statsDiv.innerHTML = `
                <strong>‚ö° ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û:</strong><br>
                ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•: ${processedCount.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå<br>
                ‡πÄ‡∏ß‡∏•‡∏≤: ${(elapsedTime / 1000).toFixed(1)} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ<br>
                ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß: ${phonesPerSecond.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå/‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            `;
            statsDiv.style.display = 'block';
        }

        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï progress bar
        function resetProgress() {
            updateProgress(0, "");
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        function showStatus(elementId, message, isError = false) {
            const element = document.getElementById(elementId);
            element.innerHTML = `<div class="${isError ? 'error-message' : 'info-box'}">${message}</div>`;
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå
        function showFileInfo(filename, size, estimatedPhones) {
            const fileInfoDiv = document.getElementById('fileInfo');
            const fileDetailsDiv = document.getElementById('fileDetails');
            
            fileDetailsDiv.innerHTML = `
                <div>‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå: ${filename}</div>
                <div>‡∏Ç‡∏ô‡∏≤‡∏î: ${(size / 1024 / 1024).toFixed(2)} MB</div>
                <div>‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£: ${estimatedPhones.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå</div>
                <div>‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î: ${MAX_PHONES_PER_FILE.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ï‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå</div>
            `;
            
            fileInfoDiv.classList.remove('hidden');
        }

        // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå
        function hideFileInfo() {
            document.getElementById('fileInfo').classList.add('hidden');
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
        function showDownloadInfo(uniqueCount) {
            const downloadInfoDiv = document.getElementById('downloadInfo');
            const uniqueCountSpan = document.getElementById('uniqueCount');
            
            uniqueCountSpan.textContent = uniqueCount.toLocaleString();
            downloadInfoDiv.classList.remove('hidden');
        }

        // ‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Å‡∏≤‡∏£‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏à‡∏≤‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå
        function estimatePhoneCount(fileSize) {
            const phonesPerMB = 10000;
            const estimated = Math.ceil((fileSize / 1024 / 1024) * phonesPerMB);
            return Math.min(estimated, MAX_PHONES_PER_FILE * 2);
        }

        // ‡πÅ‡∏™‡∏î‡∏á modal ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
        function showPasswordModal(action) {
            currentPasswordAction = action;
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordError').style.display = 'none';
            document.getElementById('passwordModal').style.display = 'block';
        }

        // ‡∏ã‡πà‡∏≠‡∏ô modal ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
        function hidePasswordModal() {
            document.getElementById('passwordModal').style.display = 'none';
            currentPasswordAction = null;
        }

        // ‡πÅ‡∏™‡∏î‡∏á modal ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        function showSettingsModal() {
            document.getElementById('settingsPasswordInput').value = '';
            document.getElementById('settingsPasswordError').style.display = 'none';
            document.getElementById('settingsModal').style.display = 'block';
        }

        // ‡∏ã‡πà‡∏≠‡∏ô modal ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        function hideSettingsModal() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        // ‡πÅ‡∏™‡∏î‡∏á modal ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        function showSettingsContentModal() {
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡πà‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏•‡∏á‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°
            document.getElementById('settingsGithubUsername').value = phoneDB.githubUsername;
            document.getElementById('settingsRepoName').value = phoneDB.repoName;
            document.getElementById('settingsGithubToken').value = phoneDB.githubToken;
            document.getElementById('settingsFilePath').value = phoneDB.filePath;
            document.getElementById('settingsAdminPassword').value = ADMIN_PASSWORD;
            document.getElementById('settingsMaxPhones').value = MAX_PHONES_PER_FILE;
            
            document.getElementById('settingsContentModal').style.display = 'block';
        }

        // ‡∏ã‡πà‡∏≠‡∏ô modal ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        function hideSettingsContentModal() {
            document.getElementById('settingsContentModal').style.display = 'none';
        }

        // ==================== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå ====================

        // ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå Excel
        async function processExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = async function(e) {
                    try {
                        updateProgress(10, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå...');
                        
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        updateProgress(30, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                        
                        if (workbook.SheetNames.length === 0) {
                            throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏µ‡∏ó‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel');
                        }
                        
                        const firstSheetName = workbook.SheetNames[0];
                        const worksheet = workbook.Sheets[firstSheetName];
                        
                        if (!worksheet || !worksheet['!ref']) {
                            throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡πÑ‡∏ü‡∏•‡πå Excel');
                        }
                        
                        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                        
                        if (jsonData.length === 0) {
                            throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel');
                        }

                        updateProgress(50, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå...');
                        
                        await processPhoneNumbersFast(jsonData);
                        
                        updateProgress(100, '‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô!');
                        setTimeout(() => {
                            resolve();
                        }, 500);
                        
                    } catch (error) {
                        reject(error);
                    }
                };
                
                reader.onerror = () => {
                    reject(new Error('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏î‡πâ - ‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏≤‡∏à‡πÄ‡∏™‡∏µ‡∏¢‡∏´‡∏≤‡∏¢'));
                };
                
                reader.readAsArrayBuffer(file);
            });
        }

        // ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß
        async function processPhoneNumbersFast(data) {
            let allPhones = [];
            let totalProcessed = 0;
            
            updateProgress(60, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå...');
            
            // ‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
            for (let i = 0; i < data.length; i++) {
                const row = data[i];
                
                if (Array.isArray(row)) {
                    for (const cell of row) {
                        if (cell !== null && cell !== undefined && cell !== '') {
                            const phone = formatPhoneNumberFast(cell.toString());
                            if (phone) {
                                allPhones.push(phone);
                                totalProcessed++;
                                
                                if (totalProcessed > MAX_PHONES_PER_FILE) {
                                    throw new Error(`‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÄ‡∏Å‡∏¥‡∏ô ${MAX_PHONES_PER_FILE.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå!`);
                                }
                            }
                        }
                    }
                }
            }

            console.log(`‡∏£‡∏ß‡∏ö‡∏£‡∏ß‡∏°‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÑ‡∏î‡πâ ${allPhones.length} ‡πÄ‡∏ö‡∏≠‡∏£‡πå`);

            if (allPhones.length === 0) {
                throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå');
            }

            updateProgress(80, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≥...');

            // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            currentUniquePhones = [];
            let totalDuplicates = 0;
            let totalUnique = 0;

            for (let i = 0; i < allPhones.length; i += CHUNK_SIZE) {
                const chunk = allPhones.slice(i, i + CHUNK_SIZE);
                
                // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
                const checkResults = phoneDB.checkMultiplePhones(chunk);
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÉ‡∏´‡∏°‡πà‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ô
                const { newCount, duplicateCount, newPhones } = await phoneDB.addMultiplePhones(checkResults);
                
                totalUnique += newCount;
                totalDuplicates += duplicateCount;
                
                // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
                currentUniquePhones.push(...newPhones);

                const progress = 80 + Math.floor((i / allPhones.length) * 15);
                updateProgress(progress, `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå... (${Math.min(i + CHUNK_SIZE, allPhones.length)} ‡∏à‡∏≤‡∏Å ${allPhones.length})`);

                // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û
                const elapsedTime = Date.now() - startTime;
                showPerformanceStats(i + chunk.length, elapsedTime);
            }

            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            await phoneDB.flush();
            
            // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            phoneDB.saveLastUpload(currentUniquePhones);

            console.log(`‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö: ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${allPhones.length}, ‡∏ã‡πâ‡∏≥ ${totalDuplicates}, ‡πÉ‡∏´‡∏°‡πà ${totalUnique}`);

            // ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
            if (phoneDB.onlineEnabled) {
                try {
                    updateProgress(95, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö GitHub...');
                    await phoneDB.saveToOnline();
                    console.log('‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                } catch (error) {
                    console.warn('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö GitHub ‡πÑ‡∏î‡πâ:', error.message);
                    // ‡πÑ‡∏°‡πà throw error ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß
                }
            }

            // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
            await displayResults(allPhones.length, totalDuplicates, totalUnique);
        }

        // ‡∏à‡∏±‡∏î‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡πá‡∏ß
        function formatPhoneNumberFast(phone) {
            let cleaned = phone.replace(/\D/g, '');
            
            if (cleaned.startsWith('66') && cleaned.length >= 10) {
                cleaned = '0' + cleaned.substring(2);
            }
            
            if ((cleaned.startsWith('0') && cleaned.length === 10) || cleaned.length === 9) {
                return cleaned;
            }
            
            return null;
        }

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö
        async function displayResults(allNumbers, duplicates, uniqueNumbers) {
            const resultDiv = document.getElementById('result');
            const summaryDiv = document.getElementById('summary');
            const totalInDB = await phoneDB.getCount();
            const elapsedTime = Date.now() - startTime;
            
            resultDiv.classList.remove('hidden');
            
            let onlineStatus = '';
            if (phoneDB.onlineEnabled) {
                onlineStatus = `<p>üåê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö GitHub ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</p>`;
            }
            
            summaryDiv.innerHTML = `
                <div class="stat-box">
                    <div class="info-box">
                        <p><strong>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö:</strong></p>
                        <p>‡∏û‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡πÑ‡∏ü‡∏•‡πå: <span class="stat-number">${allNumbers.toLocaleString()}</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå</p>
                        <p>‡∏û‡∏ö‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ã‡πâ‡∏≥: <span class="stat-number">${duplicates.toLocaleString()}</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå</p>
                        <p>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥: <span class="stat-number">${uniqueNumbers.toLocaleString()}</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå</p>
                        <p>‡∏Ç‡∏ô‡∏≤‡∏î‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: <span class="stat-number">${totalInDB.toLocaleString()}</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå</p>
                        <p>‚è±Ô∏è ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ: ${(elapsedTime / 1000).toFixed(1)} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ</p>
                        ${onlineStatus}
                        <p>‚úÖ ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</p>
                    </div>
                </div>
            `;

            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
            showDownloadInfo(uniqueNumbers);
        }

        // ==================== INITIALIZE EVENT LISTENERS ====================

        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        function initializeApp() {
            console.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°...');

            // 1. ‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            document.getElementById('settingsBtn').addEventListener('click', function() {
                console.log('‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏°‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤');
                showSettingsModal();
            });

            // 2. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            document.getElementById('confirmSettingsPasswordBtn').addEventListener('click', function() {
                const passwordInput = document.getElementById('settingsPasswordInput').value;
                
                if (passwordInput === ADMIN_PASSWORD) {
                    document.getElementById('settingsPasswordError').style.display = 'none';
                    hideSettingsModal();
                    showSettingsContentModal();
                } else {
                    document.getElementById('settingsPasswordError').style.display = 'block';
                }
            });

            // 3. ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            document.getElementById('cancelSettingsPasswordBtn').addEventListener('click', function() {
                hideSettingsModal();
            });

            // 4. ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            document.getElementById('closeSettingsBtn').addEventListener('click', function() {
                hideSettingsContentModal();
            });

            // 5. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GitHub
            document.getElementById('saveSettingsBtn').addEventListener('click', function() {
                const username = document.getElementById('settingsGithubUsername').value.trim();
                const repoName = document.getElementById('settingsRepoName').value.trim();
                const token = document.getElementById('settingsGithubToken').value.trim();
                const filePath = document.getElementById('settingsFilePath').value.trim();
                
                if (!username || !repoName || !token) {
                    showStatus('settingsStatus', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á', true);
                    return;
                }

                const newConfig = {
                    username: username,
                    repoName: repoName,
                    token: token,
                    filePath: filePath
                };
                
                phoneDB.updateConfig(newConfig);
                showStatus('settingsStatus', '‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                updateOnlineStatus(true);
            });

            // 6. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            document.getElementById('testSettingsBtn').addEventListener('click', async function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠...');
                
                try {
                    const result = await phoneDB.testConnection();
                    hideLoading();
                    showStatus('settingsStatus', result.message);
                } catch (error) {
                    hideLoading();
                    showStatus('settingsStatus', `‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`, true);
                }
            });

            // 7. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö
            document.getElementById('saveSystemSettingsBtn').addEventListener('click', function() {
                const maxPhones = parseInt(document.getElementById('settingsMaxPhones').value);
                
                if (maxPhones && maxPhones > 0) {
                    MAX_PHONES_PER_FILE = maxPhones;
                    showStatus('settingsStatus', `‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: ${maxPhones.toLocaleString()}`);
                } else {
                    showStatus('settingsStatus', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', true);
                }
            });

            // 8. ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            document.getElementById('resetSettingsBtn').addEventListener('click', function() {
                if (confirm('‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÉ‡∏ä‡πà‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                    document.getElementById('settingsGithubUsername').value = "apn8881";
                    document.getElementById('settingsRepoName').value = "datacfe";
                    document.getElementById('settingsGithubToken').value = "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";
                    document.getElementById('settingsFilePath').value = "data/phones.json";
                    document.getElementById('settingsAdminPassword').value = "23669";
                    document.getElementById('settingsMaxPhones').value = "300000";
                    
                    showStatus('settingsStatus', '‚úÖ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
                }
            });

            // 9. ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
            document.getElementById('initDatabaseBtn').addEventListener('click', async function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô GitHub...');
                
                try {
                    const result = await phoneDB.initializeDatabase();
                    hideLoading();
                    showStatus('fixStatus', 
                        '‚úÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!<br>' +
                        '‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub ‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß<br>' +
                        '<a href="' + result.commitUrl + '" target="_blank">‡∏î‡∏π Commit ‡∏ö‡∏ô GitHub</a>');
                } catch (error) {
                    hideLoading();
                    let errorMessage = `‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ: ${error.message}`;
                    
                    if (error.message.includes('‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå')) {
                        errorMessage += '<br><br>üí° <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Token ‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô repository ‡∏ô‡∏µ‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á';
                    }
                    
                    showStatus('fixStatus', errorMessage, true);
                }
            });

            // 10. ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
            document.getElementById('testConnectionBtn').addEventListener('click', async function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ GitHub...');
                
                try {
                    const result = await phoneDB.testConnection();
                    hideLoading();
                    let message = `${result.message}<br>`;
                    
                    if (result.count === 0) {
                        message += 'üìù <strong>‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏:</strong> ‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏ï‡πà‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•<br>';
                        message += '‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ';
                    }
                    
                    message += `<a href="${phoneDB.getFileUrl()}" target="_blank">‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô GitHub</a>`;
                    
                    showStatus('fixStatus', message);
                } catch (error) {
                    hideLoading();
                    let errorMessage = `‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`;
                    
                    if (error.message.includes('404')) {
                        errorMessage += '<br><br>üìù <strong>‡πÑ‡∏ü‡∏•‡πå‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ:</strong> ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå data/phones.json ‡∏Å‡πà‡∏≠‡∏ô';
                    }
                    
                    showStatus('fixStatus', errorMessage, true);
                }
            });

            // 11. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠
            document.getElementById('checkManualSetupBtn').addEventListener('click', async function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤...');
                
                try {
                    const result = await phoneDB.testConnection();
                    hideLoading();
                    
                    if (result.success) {
                        showStatus('fixStatus', 
                            '‚úÖ ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!<br>' +
                            '‡πÑ‡∏ü‡∏•‡πå data/phones.json ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß<br>' +
                            `<a href="${phoneDB.getFileUrl()}" target="_blank">‡∏î‡∏π‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô GitHub</a>`);
                    }
                } catch (error) {
                    hideLoading();
                    showStatus('fixStatus', 
                        '‚ùå ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå data/phones.json<br>' +
                        '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏≥‡∏ï‡∏≤‡∏°‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏î‡πâ‡∏ß‡∏¢‡∏°‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', true);
                }
            });

            // 12. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô GitHub
            document.getElementById('viewOnlineBtn').addEventListener('click', function() {
                const url = phoneDB.getOnlineUrl();
                if (url) {
                    window.open(url, '_blank');
                } else {
                    showStatus('fixStatus', '‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö URL ‡∏Ç‡∏≠‡∏á repository', true);
                }
            });

            // 13. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
            document.getElementById('uploadBtn').addEventListener('click', async function() {
                const fileInput = document.getElementById('fileInput');
                const file = fileInput.files[0];
                const uploadBtn = document.getElementById('uploadBtn');
                
                if (!file) {
                    showStatus('uploadStatus', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel ‡∏Å‡πà‡∏≠‡∏ô', true);
                    return;
                }

                if (!file.name.match(/\.(xlsx|xls)$/)) {
                    showStatus('uploadStatus', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel (.xlsx ‡∏´‡∏£‡∏∑‡∏≠ .xls) ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', true);
                    return;
                }

                if (file.size > 50 * 1024 * 1024) {
                    showStatus('uploadStatus', '‚ùå ‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 50MB)', true);
                    return;
                }

                startTime = Date.now();
                uploadBtn.disabled = true;
                uploadBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...';
                showStatus('uploadStatus', '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå...');

                try {
                    showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå Excel...');
                    
                    setTimeout(async () => {
                        try {
                            await processExcelFile(file);
                            let successMessage = '‚úÖ ‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô! ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏ß‡∏ô "‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö"';
                            if (phoneDB.onlineEnabled) {
                                successMessage += '<br>üåê ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ñ‡∏π‡∏Å‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Å‡∏±‡∏ö GitHub ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢';
                            }
                            showStatus('uploadStatus', successMessage);
                        } catch (error) {
                            console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
                            showStatus('uploadStatus', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, true);
                        } finally {
                            hideLoading();
                            uploadBtn.disabled = false;
                            uploadBtn.textContent = '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
                        }
                    }, 100);
                    
                } catch (error) {
                    console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:', error);
                    showStatus('uploadStatus', `‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`, true);
                    hideLoading();
                    uploadBtn.disabled = false;
                    uploadBtn.textContent = '‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö';
                }
            });

            // 14. ‡∏î‡∏π‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            document.getElementById('viewDbBtn').addEventListener('click', async function() {
                const dbInfo = document.getElementById('dbInfo');
                const dbCount = document.getElementById('dbCount');
                
                dbInfo.classList.remove('hidden');
                const count = await phoneDB.getCount();
                const lastUpload = phoneDB.getLastUploadData();
                const onlineStatus = phoneDB.onlineEnabled ? '‚úÖ ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‚ùå ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                
                let onlineInfo = '';
                if (phoneDB.onlineEnabled) {
                    onlineInfo = `<p>üìÅ Repository: <a href="https://github.com/${phoneDB.githubUsername}/${phoneDB.repoName}" target="_blank">${phoneDB.githubUsername}/${phoneDB.repoName}</a></p>`;
                }
                
                dbCount.innerHTML = `
                    <div class="info-box">
                        <p><strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</strong></p>
                        <p>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: <span class="stat-number">${count.toLocaleString()}</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå</p>
                        <p>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: <span class="stat-number">${lastUpload.length.toLocaleString()}</span> ‡πÄ‡∏ö‡∏≠‡∏£‡πå</p>
                        <p>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• GitHub: ${onlineStatus}</p>
                        ${onlineInfo}
                        <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏Ç‡∏ô‡∏≤‡∏î</p>
                    </div>
                `;
            });

            // 15. ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            document.getElementById('exportDbBtn').addEventListener('click', async function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                
                setTimeout(async () => {
                    try {
                        const allPhones = await phoneDB.exportToArray();
                        
                        if (allPhones.length === 0) {
                            alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•');
                            hideLoading();
                            return;
                        }
                        
                        const wb = XLSX.utils.book_new();
                        const phoneData = allPhones.map(phone => [phone]);
                        phoneData.unshift(['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå']);
                        
                        const ws = XLSX.utils.aoa_to_sheet(phoneData);
                        XLSX.utils.book_append_sheet(wb, ws, '‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£');
                        
                        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                        const filename = `‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£_${timestamp}.xlsx`;
                        
                        XLSX.writeFile(wb, filename);
                        
                        hideLoading();
                        alert(`‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${allPhones.length.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå`);
                    } catch (error) {
                        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å:', error);
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
                        hideLoading();
                    }
                }, 100);
            });

            // 16. ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå
            document.getElementById('downloadBtn').addEventListener('click', async function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå Excel...');
                
                setTimeout(async () => {
                    try {
                        const phonesToDownload = phoneDB.getLastUploadData();
                        
                        if (phonesToDownload.length === 0) {
                            alert('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Å‡πà‡∏≠‡∏ô');
                            hideLoading();
                            return;
                        }
                        
                        const wb = XLSX.utils.book_new();
                        const phoneData = phonesToDownload.map(phone => [phone]);
                        phoneData.unshift(['‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå']);
                        
                        const ws = XLSX.utils.aoa_to_sheet(phoneData);
                        XLSX.utils.book_append_sheet(wb, ws, '‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£');
                        
                        const timestamp = new Date().toISOString().slice(0, 19).replace(/:/g, '-');
                        const filename = `‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥_${timestamp}.xlsx`;
                        
                        XLSX.writeFile(wb, filename);
                        
                        hideLoading();
                        alert(`‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏°‡∏µ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${phonesToDownload.length.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥‡∏à‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î`);
                    } catch (error) {
                        console.error('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå:', error);
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå');
                        hideLoading();
                    }
                }, 100);
            });

            // 17. ‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            document.getElementById('clearDbBtn').addEventListener('click', function() {
                showPasswordModal('clearDatabase');
            });

            // 18. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
            document.getElementById('saveToOnlineBtn').addEventListener('click', function() {
                showPasswordModal('saveToOnline');
            });

            // 19. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå
            document.getElementById('loadFromOnlineBtn').addEventListener('click', function() {
                showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub...');
                
                phoneDB.loadFromOnline()
                    .then(result => {
                        let message = `‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!<br>`;
                        if (result.onlineCount === 0) {
                            message += `‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô GitHub (‡πÑ‡∏ü‡∏•‡πå‡∏ß‡πà‡∏≤‡∏á)<br>`;
                        } else {
                            message += `‡∏û‡∏ö ${result.onlineCount.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå<br>`;
                        }
                        message += `‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà ${result.newCount.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå<br>`;
                        message += `‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${result.totalCount.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå`;
                        
                        showStatus('configStatus', message);
                    })
                    .catch(error => {
                        let errorMessage = `‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`;
                        if (error.message.includes('‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•')) {
                            errorMessage += '<br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç';
                        }
                        showStatus('configStatus', errorMessage, true);
                    })
                    .finally(() => {
                        hideLoading();
                    });
            });

            // 20. ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
            document.getElementById('confirmPasswordBtn').addEventListener('click', async function() {
                const passwordInput = document.getElementById('passwordInput').value;
                
                if (passwordInput === ADMIN_PASSWORD) {
                    document.getElementById('passwordError').style.display = 'none';
                    
                    if (currentPasswordAction === 'saveToOnline') {
                        hidePasswordModal();
                        showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub...');
                        
                        try {
                            const result = await phoneDB.saveToOnline();
                            showStatus('configStatus', 
                                `‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á GitHub ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!<br>
                                 ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ${result.savedCount.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå<br>
                                 <a href="${result.commitUrl}" target="_blank">‡∏î‡∏π Commit ‡∏ö‡∏ô GitHub</a><br>
                                 ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î`);
                        } catch (error) {
                            showStatus('configStatus', `‚ùå ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ${error.message}`, true);
                        } finally {
                            hideLoading();
                        }
                        
                    } else if (currentPasswordAction === 'clearDatabase') {
                        hidePasswordModal();
                        showLoading('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                        
                        try {
                            await phoneDB.clear();
                            document.getElementById('dbInfo').classList.add('hidden');
                            document.getElementById('result').classList.add('hidden');
                            document.getElementById('downloadInfo').classList.add('hidden');
                            hideLoading();
                            showStatus('uploadStatus', '‚úÖ ‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                        } catch (error) {
                            hideLoading();
                            showStatus('uploadStatus', '‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', true);
                        }
                    }
                    
                } else {
                    document.getElementById('passwordError').style.display = 'block';
                }
            });

            // 21. ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
            document.getElementById('cancelPasswordBtn').addEventListener('click', function() {
                hidePasswordModal();
            });

            // 22. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            document.getElementById('fileInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const estimatedPhones = estimatePhoneCount(file.size);
                    showFileInfo(file.name, file.size, estimatedPhones);
                    
                    if (estimatedPhones > MAX_PHONES_PER_FILE) {
                        showStatus('uploadStatus', `‚ö†Ô∏è ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà ‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡πÄ‡∏Å‡∏¥‡∏ô ${MAX_PHONES_PER_FILE.toLocaleString()} ‡πÄ‡∏ö‡∏≠‡∏£‡πå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏ü‡∏•‡πå`, true);
                    } else {
                        showStatus('uploadStatus', '‚úÖ ‡πÑ‡∏ü‡∏•‡πå‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î');
                    }
                } else {
                    hideFileInfo();
                    showStatus('uploadStatus', 'üìÅ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö');
                }
            });

            console.log('‚úÖ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
        }

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM Content Loaded - ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°...');
            initializeApp();
            showStatus('uploadStatus', 'üìÅ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö');
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            const lastUpload = phoneDB.getLastUploadData();
            if (lastUpload.length > 0) {
                showDownloadInfo(lastUpload.length);
            }
        });

    </script>
</body>
</html>
